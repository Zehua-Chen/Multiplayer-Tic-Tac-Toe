!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n};Object.defineProperty(n,"__esModule",{value:!0});const i=r(t(1)),a=r(t(2)),s=r(t(3)),l=o(t(4)),d=o(t(5)),u=o(t(6)),c=t(7),f=t(9),h=`http://${c.findIpv4()}:3001/`,m=i.default();var p=d.resolve(d.join(".","/"),d.join(".","public"));m.use(i.default.static(p)),m.use(s.default.json());const g=l.createServer(m),_=a.default(g,{serveClient:!1});var v,y,b,P,j=0,O=9,w={name:""},M={name:""};g.listen(3001,()=>{console.log(" Game hosted at http://localhost:3001/"),console.log(` Game hosted at ${h}`),console.log(),console.log("Game Logs:"),console.log(),m.get("/",(e,n)=>{n.sendFile("index.html")}),m.get("/host_address",(e,n)=>{n.send(h)}),m.get("/players",(e,n)=>{var t=new Array(2);""!=w.name&&(t[0]=w),""!=M.name&&(t[1]=M);var r={players:t};n.send(r)}),m.get("/progress",(e,n)=>{var t={remaining:O,total:9};n.send(t)}),m.get("/winner",(e,n)=>{var t=void 0;b&&""!=b.name&&(t=v),n.send(t)}),m.get("/board",(e,n)=>{var t=void 0;y&&(t=y.board),n.send(t)}),m.post("/create_game",(e,n)=>{var t={success:!1},r=e.body;if(""==r.name)return t.success=!1,t.message='Name cannot be "" (empty)',void n.send(t);y?t.message="There is a board already created.":(w.name=r.name,P=r.invitationCode,(y=new f.Board(3,"?"))||(t.message="Unable to create board.",console.log("'/create_board': Unable to create board;")),t.success=!0,console.log(`'/create_game': new game created, creator = ${r.name}`),_.emit("new_player",w)),n.send(t)}),m.post("/join_game",(e,n)=>{var t=e.body,r={success:!1};if(""==t.name)return r.success=!1,r.message='Name cannot be "" (empty)',void n.send(r);""==M.name?y?t.invitationCode==P?t.name!=w.name?(M.name=t.name,r.success=!0,console.log(`'/join_game': new player joined = ${M.name};`),_.emit("new_player",M)):(r.message="Two players cannot have the same name.",console.log("/join_game': name conflict caused by the new player;")):(r.message="Incorrect invitation code;",console.log("'/join_game': incorrect invitation code;")):(console.log("'/join_game': a game has not been created;"),r.message="A game has not been created."):(console.log("'/join_game': already have two player, cannot take any more;"),r.message="Max of two player reached."),n.send(r)}),_.on("connection",e=>{j++,_.emit("update_user#",j),e.on("move",e=>{if(v)return;var n=e,t=n.location.y,r=n.location.x;const{name:o,invitationCode:i}=n;if(i==P&&(!b||b.name==o)){o==w.name?(y.setAt(t,r,w),b=M):o==M.name&&(y.setAt(t,r,M),b=w),console.log(`websocket: 'move': ${n.name} at (y: ${t}, x: ${r};`),console.log(y.board);var a={name:o,location:n.location};_.emit("new_move",a),b&&""!=b.name&&_.emit("update_moving",b);var s={remaining:--O,total:9};_.emit("update_progress",s);var l=y.findWinner();l&&(v=l,_.emit("found_winner",l))}}),e.on("disconnect",()=>{console.log("User disconnected"),j--,_.emit(u.UPDATED_USER_AMOUNT,j)})})})},function(e,n){e.exports=require("express")},function(e,n){e.exports=require("socket.io")},function(e,n){e.exports=require("body-parser")},function(e,n){e.exports=require("http")},function(e,n){e.exports=require("path")},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.HAD_ENOUGH_PLAYER="had_enough_player",n.UPDATED_HOST="updated_host",n.UPDATED_USER_AMOUNT="updated-user__amount",n.UPDATED_PROGRESS="updated-progress"},function(e,n,t){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n};Object.defineProperty(n,"__esModule",{value:!0});const o=r(t(8));n.findIpv4=function(){var e="NOT FOUND!",n=o.networkInterfaces();for(const t in n)n[t].forEach((n,t,r)=>{"IPv4"==n.family&&0==n.internal&&(e=n.address)});return e}},function(e,n){e.exports=require("os")},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=t(10);n.Board=r.Board},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.Board=class{constructor(e=3,n){if(this.dimension=e,this.defaultValue=n,0==this.dimension)throw new Error("Dimension needs to be bigger than 0!");if(this._board=new Array(this.dimension),this._board)for(var t=0;t<this._board.length;t++){this._board[t]=new Array(this.dimension);for(var r=0;r<this._board[t].length;r++)this.defaultValue&&(this._board[t][r]=this.defaultValue)}}get board(){return this._board}toString(){var e="";return this._board&&this._board.forEach(n=>{var t="";n.forEach(e=>{t+=e+" "}),e+=t+"\n"}),e}setAt(e,n,t){this._board[e][n]=t.name,this.playerA?this.playerA==t||this.playerB||(this.playerB=t):this.playerA=t}findMatchingPlayer(e){return this.playerA&&e==this.playerA.name?this.playerA:this.playerB?this.playerB:null}findVerticalWinner(){for(var e=0;e<this.dimension;e++){for(var n,t,r=0,o=0,i=0;i<this.dimension;i++){var a=this._board[i][e];a&&a!=this.defaultValue&&(a==n?r++:a==t&&o++,n?t||n==a||(t=a,o++):(n=a,r++))}if(r==this.dimension&&n)return this.findMatchingPlayer(n);if(o==this.dimension&&t)return this.findMatchingPlayer(t)}return null}findHorizontalWinner(){for(var e=0;e<this.dimension;e++){for(var n,t,r=0,o=0,i=0;i<this.dimension;i++){var a=this._board[e][i];a&&a!=this.defaultValue&&(a==n?r++:a==t&&o++,n?t||n==a||(t=a,o++):(n=a,r++))}if(r==this.dimension&&n)return this.findMatchingPlayer(n);if(o==this.dimension&&t)return this.findMatchingPlayer(t)}return null}findDiagnolWinner(){var e;return(e=this.findDiagnolWinnerTopLeftToBottomRight())?this.findMatchingPlayer(e):(e=this.findDiagnolWinnerTopRightToBottomLeft())?this.findMatchingPlayer(e):null}findDiagnolWinnerTopLeftToBottomRight(){for(var e,n,t=0,r=0,o=0,i=0;o<this.dimension&&i<this.dimension;){var a=this._board[i][o];a&&a!=this.defaultValue&&(a==e?t++:a==n&&r++,e?n||e==a||(n=a,r++):(e=a,t++)),o++,i++}return t==this.dimension&&e?e:r==this.dimension&&n?n:null}findDiagnolWinnerTopRightToBottomLeft(){for(var e,n,t=0,r=0,o=this.dimension-1,i=0;o>=0&&i<this.dimension;){var a=this._board[i][o];a&&a!=this.defaultValue&&(a==e?t++:a==n&&r++,e?n||e==a||(n=a,r++):(e=a,t++)),o--,i++}return t==this.dimension&&e?e:r==this.dimension&&n?n:null}findWinner(){var e=this.findHorizontalWinner();return e||((e=this.findVerticalWinner())?e:e=this.findDiagnolWinner())}}}]);